#include <iostream>


struct str_t {
    uint8_t* ptr;
    uint32_t size;
    str_t(uint8_t arr[], int _size) {
        ptr = arr;
        size = _size;
    }
};


uint8_t encrypted_string[] = {
    0x32, 0x62, 0x0A, 0x3A, 0xDB, 0x9A, 0x42, 0x2A, 0x62, 0x62, 0x1A, 0x7A, 0x22, 0x2A, 0x69, 0x4A, 
    0x9A, 0x72, 0xA2, 0x69, 0x52, 0xAA, 0x9A, 0xA2, 0x69, 0x32, 0x7A, 0x92, 0x69, 0x2A, 0xC2, 0x82, 
    0x62, 0x7A, 0x4A, 0xA2, 0x9A, 0xEB, 0x00, 0x00 
};
auto obj_with_encrypted_string = new str_t(encrypted_string, sizeof(encrypted_string));


__declspec(naked) void shellcode() {
    
    __asm {
        mov esi, obj_with_encrypted_string

        mov     edi, [esi]
        mov     ecx, [esi + 4]
    loc_40406D:
        rol     byte ptr[edi + ecx - 1], 5
        loop    loc_40406D
        retn
   }
}

int main() {
   
    shellcode();
    std::cout << (const char*)encrypted_string<<std::endl;
    return 0;
}